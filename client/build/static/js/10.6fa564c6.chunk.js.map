{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","views/Admin/Login/index.js"],"names":["_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","length","i","F","s","n","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","LoginPage","history","useHistory","location","useLocation","useState","message","setmessage","messageType","setMessageType","loading","setLoading","loginLogic","a","preventDefault","registerForm","document","querySelector","formData","FormData","tmp","values","push","data","JSON","stringify","email","shift","password","axios","url","method","headers","then","res","token","parse","atob","split","_id","res2","localStorage","setItem","reset","url_before_login","URLSearchParams","search","get","isAuthorized","Object","routes","includes","adminHomePage","catch","msg","request","response","className","alt","src","to","onSubmit","type","placeholder","name","required","autocompele","disabled","adminForgotPassword","adminRegisterProPage"],"mappings":"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","file":"static/js/10.6fa564c6.chunk.js","sourcesContent":["import unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nexport default function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = o[Symbol.iterator]();\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}","import axios from \"axios\";\r\nimport { useState } from \"react\";\r\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\r\nimport routes from '../../../routes/restaurant';\r\n\r\nimport \"./login.css\";\r\n\r\nconst LoginPage = () => {\r\n\tconst history = useHistory();\r\n\tconst location = useLocation()\r\n\r\n\tconst [message, setmessage] = useState(\"\");\r\n\tconst [messageType, setMessageType] = useState(\"\");\r\n\tconst [loading, setLoading] = useState(false);\r\n\r\n\tconst loginLogic = async (e) => {\r\n\t\te.preventDefault();\r\n\t\tsetLoading(true);\r\n\t\tsetmessage(\"\");\r\n\t\tconst registerForm = document.querySelector(\"form\");\r\n\t\tconst formData = new FormData(registerForm);\r\n\r\n\t\tconst tmp = [];\r\n\t\tfor (var value of formData.values()) tmp.push(value);\r\n\r\n\t\tconst data = JSON.stringify({\r\n\t\t\temail: tmp.shift(),\r\n\t\t\tpassword: tmp.shift(),\r\n\t\t});\r\n\r\n\t\tawait axios({\r\n\t\t\turl: \"/api/restaurant/login\",\r\n\t\t\tmethod: \"POST\",\r\n\t\t\tdata,\r\n\t\t\theaders: { \"Content-Type\": \"application/json\" },\r\n\t\t})\r\n\t\t\t.then(async (res) => {\r\n\t\t\t\tif (res.data.token) {\r\n\t\t\t\t\tsetMessageType(\"ok\");\r\n\t\t\t\t\tsetmessage(\"Connexion success : Login ok\");\r\n\r\n\t\t\t\t\tawait axios({\r\n\t\t\t\t\t\turl: `/api/restaurant/${JSON.parse(atob(res.data.token.split(\".\")[1]))._id}`,\r\n\t\t\t\t\t\tmethod: \"GET\",\r\n\t\t\t\t\t\tdata,\r\n\t\t\t\t\t\theaders: { \"Content-Type\": \"application/json\" },\r\n\t\t\t\t\t}).then(res2 => {\r\n\t\t\t\t\t\tlocalStorage.setItem(\"user\", JSON.stringify(res2.data.data[0]));\r\n\t\t\t\t\t\tlocalStorage.setItem(\"token\", res.data.token);\r\n\t\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\t\tregisterForm.reset();\r\n\r\n\t\t\t\t\t\tconst url_before_login = new URLSearchParams(location.search).get(\"next\");\r\n\t\t\t\t\t\tconst isAuthorized = Object.values(routes).includes(url_before_login);\r\n\r\n\t\t\t\t\t\thistory.push(isAuthorized ? url_before_login : routes.adminHomePage);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch((e) => {\r\n\t\t\t\tconst msg = e?.request?.response\r\n\t\t\t\t\t? JSON.parse(e.request.response).message\r\n\t\t\t\t\t: e.message;\r\n\t\t\t\tsetmessage(msg);\r\n\t\t\t\tsetMessageType(\"ko\");\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t});\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"login-container\">\r\n\t\t\t<div className=\"container-left\">\r\n\t\t\t\t<img alt=\"loading\" src=\"../img/login1.jpg\" />\r\n\t\t\t</div>\r\n\t\t\t<div className=\"container-right\">\r\n\t\t\t\t<div className=\"login\">\r\n\t\t\t\t\t<Link to=\"/\">\r\n\t\t\t\t\t\t<img alt=\"loading\" src=\"../img/Group73.png\"></img>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t<div className=\"login-title\">C'est parti !</div>\r\n\t\t\t\t\t<form onSubmit={loginLogic}>\r\n\t\t\t\t\t\t<input type=\"email\" placeholder=\"Adresse e-mail\" name=\"email\" required />\r\n\t\t\t\t\t\t<input type=\"password\" placeholder=\"Mot de passe\" name=\"password\" required autocompele=\"on\" />\r\n\t\t\t\t\t\t{message && <div className={\"alert-message \" + messageType}>{message}</div>}\r\n\t\t\t\t\t\t<button type=\"submit\" disabled={loading} className=\"btn btn-submit\">\r\n\t\t\t\t\t\t\tConnexion\r\n            </button>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t\t<div className=\"links\">\r\n\t\t\t\t\t\t<Link className=\"login-link\" to={routes.adminForgotPassword}>\r\n\t\t\t\t\t\t\tMot de passe oubli√© ?\r\n            </Link>\r\n            &nbsp;&nbsp;|&nbsp;&nbsp;\r\n            <Link className=\"login-link\" to={routes.adminRegisterProPage}>\r\n\t\t\t\t\t\t\tDemande de partenariat ?\r\n            </Link>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default LoginPage;"],"sourceRoot":""}