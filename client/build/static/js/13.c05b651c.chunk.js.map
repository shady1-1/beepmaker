{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","views/Admin/ResetPassword/index.js"],"names":["_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","length","i","F","s","n","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","LoginPage","useState","message","setMessage","messageType","setMessageType","loading","setLoading","token","setToken","canUpdate","setCanUpdate","params","useParams","resetPasswordLogic","a","preventDefault","resetPasswordForm","document","querySelector","formData","FormData","tmp","values","push","data","JSON","stringify","newPassword1","shift","newPassword2","axios","url","method","headers","Authorization","then","res","reset","test","m","split","pop","b","slice","success","catch","msg","request","response","parse","useEffect","_mailToken","fetchData","className","alt","src","to","onSubmit","type","placeholder","name","required","disabled","routes","adminForgotPassword","adminLoginPage"],"mappings":"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","file":"static/js/13.c05b651c.chunk.js","sourcesContent":["import unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nexport default function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = o[Symbol.iterator]();\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}","import axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { Link, useParams } from \"react-router-dom\";\r\nimport routes from \"../../../routes/restaurant\";\r\n\r\nimport \"./reset-password.css\";\r\n\r\nconst LoginPage = () => {\r\n  const [message, setMessage] = useState(\"\");\r\n  const [messageType, setMessageType] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [token, setToken] = useState(null);\r\n  const [canUpdate, setCanUpdate] = useState(true);\r\n\tconst params=useParams();\r\n\r\n  const resetPasswordLogic = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setMessage(\"\");\r\n    const resetPasswordForm = document.querySelector(\"form\");\r\n    const formData = new FormData(resetPasswordForm);\r\n\r\n    const tmp = [];\r\n    for (var value of formData.values()) tmp.push(value);\r\n\r\n    const data = JSON.stringify({\r\n      newPassword1: tmp.shift(),\r\n      newPassword2: tmp.shift(),\r\n    });\r\n\r\n    await axios({\r\n      url: \"/api/restaurant/resetPassword\",\r\n      method: \"POST\",\r\n      data,\r\n      headers: {\r\n        Authorization: `auth-token:${token}`,\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    })\r\n      .then((res) => {\r\n        resetPasswordForm.reset();\r\n        setMessage(res.data.message);\r\n\r\n        if (/`/.test(res.data.message)) {\r\n          var m = res.data.message.split(\"`\");\r\n          var a = m.pop();\r\n          var b = m.pop();\r\n\r\n          setMessage(`New passwords length (${b.length}) ${a.slice(2)}`);\r\n        }\r\n        setMessageType(res.data.success ? \"ok\" : \"ko\");\r\n        setLoading(false);\r\n        setCanUpdate(false);\r\n      })\r\n      .catch((e) => {\r\n        resetPasswordForm.reset();\r\n        const msg = e?.request?.response\r\n          ? JSON.parse(e.request.response).message\r\n          : e.message;\r\n        setMessage(msg);\r\n        setMessageType(\"ko\");\r\n        setLoading(false);\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    const mailToken = params.token;\r\n\r\n    async function fetchData(_mailToken) {\r\n      setLoading(true);\r\n\r\n      await axios({\r\n        url: \"/api/restaurant/verify-forgotPassword\",\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `auth-token:${_mailToken}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      })\r\n        .then((res) => {\r\n          setToken(res?.data?.token);\r\n          setMessage(res?.data?.message);\r\n          setMessageType(res?.data?.success ? \"ok\" : \"ko\");\r\n          res?.data?.success === false && setCanUpdate(false);\r\n          setLoading(false);\r\n        })\r\n        .catch((e) => {\r\n          const msg = e?.request?.response\r\n            ? JSON.parse(e.request.response).message\r\n            : e.message;\r\n          setMessage(msg);\r\n          setMessageType(\"ko\");\r\n          setCanUpdate(false);\r\n          setLoading(false);\r\n        });\r\n    }\r\n\r\n    fetchData(mailToken);\r\n  }, [params]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"resetPassword-container\">\r\n        <div className=\"container-left\">\r\n          <img alt=\"loading\" src=\"../img/login3.jpg\" />\r\n        </div>\r\n        <div className=\"container-right\">\r\n          {loading ? (\r\n            <div className=\"container-loader\">\r\n              <div className=\"loader\"></div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"login\">\r\n              <Link to=\"/\">\r\n                <img alt=\"loading\" src=\"../img/Group73.png\"></img>\r\n              </Link>\r\n              {canUpdate === true ? (\r\n                <>\r\n                  <div className=\"login-title\">Modifier votre mot de passe</div>\r\n                  <form onSubmit={resetPasswordLogic}>\r\n                    <input\r\n                      type=\"password\"\r\n                      placeholder=\"Nouveau mot de passe\"\r\n                      name=\"new-password1\"\r\n                      required\r\n                    ></input>\r\n                    <input\r\n                      type=\"password\"\r\n                      placeholder=\"Vérifier le nouveau mot de passe\"\r\n                      name=\"new-password2\"\r\n                      required\r\n                    ></input>\r\n                    {message && (\r\n                      <div className={\"alert-message \" + messageType}>\r\n                        {message}\r\n                      </div>\r\n                    )}\r\n                    <button\r\n                      type=\"submit\"\r\n                      disabled={loading}\r\n                      className=\"btn btn-submit\"\r\n                    >\r\n                      Modifier\r\n                    </button>\r\n                  </form>\r\n                </>\r\n              ) : (\r\n                message && (\r\n                  <>\r\n                    <div className={\"alert-message \" + messageType}>\r\n                      {message}\r\n                    </div>\r\n                    {messageType === \"ko\" ? (\r\n                      <Link\r\n                        className=\"login-link\"\r\n                        to={routes.adminForgotPassword}\r\n                      >\r\n                        Envoyer un autre Email ?\r\n                      </Link>\r\n                    ) : (\r\n                      <Link className=\"login-link\" to={routes.adminLoginPage}>\r\n                        Page de connexion ?\r\n                      </Link>\r\n                    )}\r\n                  </>\r\n                )\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default LoginPage;\r\n"],"sourceRoot":""}