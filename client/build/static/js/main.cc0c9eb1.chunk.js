(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{128:function(e,t,n){},129:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(39),i=n.n(c),s=n(21),o=n(3),u=(n(72),n(9)),d=n(5),b=n(26),l=n(34),p=n(36),m={ClientRoute:"/restaurant/beep/:restaurantId"},j=Object(u.a)(Object(u.a)(Object(u.a)({},p.a),l.a),m),O=n(1),h=["component","restricted"],f=function(e){var t=e.component,n=e.restricted,r=Object(b.a)(e,h),c=Object(a.useState)(!1),i=Object(d.a)(c,2),s=i[0],l=i[1],p=Object(a.useState)(),m=Object(d.a)(p,2),f=m[0],g=m[1],x={admin:j.adminHomePage,superAdmin:j.superAdminHomePage};return Object(a.useEffect)((function(){var e=localStorage.getItem("token"),t=localStorage.getItem("admin-token");e?(g(e),l("admin")):t&&(g(t),l("superAdmin"))}),[]),Object(O.jsx)(o.b,Object(u.a)(Object(u.a)({},r),{},{render:function(e){return f&&n?Object(O.jsx)(o.a,{to:x[s]}):Object(O.jsx)(t,Object(u.a)(Object(u.a)({},e),{},{type:r.type}))}}))},g=n(2),x=n.n(g),v=n(6),y=n(17),w=n.n(y),P=["component"],k=function(e){var t=e.component,n=Object(b.a)(e,P),r=Object(a.useState)(!0),c=Object(d.a)(r,2),i=c[0],s=c[1],l=Object(a.useState)(!1),p=Object(d.a)(l,2),m=p[0],h=p[1],f=Object(a.useState)(!1),g=Object(d.a)(f,2),y=g[0],k=g[1],S={admin:j.adminHomePage,superAdmin:j.superAdminHomePage},N=function(){var e=Object(v.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w()({url:localStorage.getItem("admin-token")?"/api/admin/connect":"/api/restaurant/admin/connect",method:"GET",headers:{Authorization:"auth-token:".concat(t),"Content-Type":"application/json"}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e=localStorage.getItem("token"),t=localStorage.getItem("admin-token");e?k("admin"):t&&k("superAdmin");var n=e||t;n?function(){var e=Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(n).then((function(e){!1===e.data.success?(h(!1),localStorage.removeItem("token"),localStorage.removeItem("admin-token")):h(!0),s(!1)})).catch((function(e){}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()():(s(!1),h(!1))}),[]),Object(O.jsx)(o.b,Object(u.a)(Object(u.a)({},n),{},{render:function(e){return i?Object(O.jsx)(O.Fragment,{}):m?n.requiredRole===y?Object(O.jsx)(t,Object(u.a)({},e)):Object(O.jsx)(o.a,{to:{pathname:S[y],state:{from:e.location}}}):Object(O.jsx)(o.a,{to:{pathname:"admin"===n.requiredRole?j.adminLoginPage:j.superAdminLoginPage,search:n.path.toLowerCase()===e.location.pathname.toLowerCase()&&"?next=".concat(n.path),state:{from:e.location}}})}}))},S=function(e){var t=e.beep;return Object(O.jsx)("div",{className:"beep-details",children:Object(O.jsxs)("div",{className:"beep-generated",children:[Object(O.jsx)("div",{className:"beep-img-container",children:Object(O.jsx)("img",{src:"../../../img/beep_logo.png",alt:"loading..."})}),Object(O.jsxs)("div",{className:"content",children:[Object(O.jsxs)("div",{className:"beep-head",children:[Object(O.jsx)("img",{src:"../../../img/beep_badge.png",alt:"loading..."}),Object(O.jsx)("div",{className:"badge-text",children:"Code g\xe9n\xe9rer avec succ\xe8s"})]}),Object(O.jsxs)("div",{className:"separation",children:[Object(O.jsx)("div",{className:"circle-1"}),Object(O.jsx)("div",{className:"circle-2"})]}),Object(O.jsxs)("div",{className:"beep-body",children:[Object(O.jsx)("div",{className:"beep-body-title",children:"Votre num\xe9ro est"}),Object(O.jsxs)("div",{className:"beep-details-number",children:["N\xb0",t.numero]}),Object(O.jsx)("div",{className:"beep-body-generate-time beep-body-title",children:"ce num\xe9ro a une dur\xe9 de 3 heures"}),t.ready&&Object(O.jsx)("div",{className:"beep-body-ready",children:"Votre commande est pr\xeate"}),Object(O.jsx)("div",{className:"beep-bottom-effect"})]})]})]})})},N=n(49),R=function(e){var t=e.setBeepToken,n=e.restaurantId,r=(e.setShowBepp,Object(a.useState)(!1)),c=Object(d.a)(r,2),i=c[0],s=c[1],o=function(){var e=Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.next=3,Object(N.a)(n).then((function(e){s(!1),localStorage.setItem("beepToken",e),t(e)})).catch((function(e){}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(O.jsx)("button",{className:"btn-submit btn text",disabled:i,onClick:o,children:"G\xe9n\xe9rer un beep"})},A=n(50),z=n.n(A),I=n(67),C=n.n(I),T=(n(128),function(){var e=Object(o.i)().restaurantId,t=Object(a.useState)(""),n=Object(d.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(null),s=Object(d.a)(i,2),u=s[0],b=s[1],l=Object(a.useState)(!1),p=Object(d.a)(l,2),m=p[0],j=p[1],h=Object(a.useState)(localStorage.getItem("beepToken")||null),f=Object(d.a)(h,2),g=f[0],y=f[1],P=Object(a.useRef)();window.OneSignal=window.OneSignal||[];var k=window.OneSignal;Object(a.useEffect)((function(){k.push((function(){k.init({appId:"d5ac5184-7776-4e38-b5bd-6ae8aa57fa95",safari_web_id:"web.onesignal.auto.3b9e77c1-5852-4edd-a278-c29c156a72b0",notifyButton:{enable:!0},welcomeNotification:{title:"One Signal",message:"Thanks for subscribing!"}})}))}),[]),Object(a.useEffect)((function(){N(),P.current&&P.current.offAny(),g&&(P.current=z()("/"),P.current.emit("auth",{beepToken:g}),P.current.on("auth",(function(e){e.success?(b(e.beep),j(!0)):(y(null),localStorage.removeItem("beepToken"))})),P.current.on("getUpdate",(function(e){var t=e.beep;switch(e.change){case"delete":localStorage.removeItem("beepToken"),b(null),y(null),j(!1);break;case"call":console.log("test"),b(t),C()({title:"Warning",subtitle:"This is a subtitle",message:"This is a very long message",theme:"darkblue",native:!0});break;default:b(t)}})))}),[g]);var N=function(){var t=Object(v.a)(x.a.mark((function t(){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w()({url:"/api/restaurant/".concat(e),method:"GET",headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(v.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.data&&c(t.data.data[0].imageURL);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(O.jsxs)("div",{className:"beep-client",children:[!m&&Object(O.jsx)("div",{className:"beep-client-container",children:Object(O.jsxs)("div",{className:"beep-client-sub-container",children:[Object(O.jsx)("img",{alt:"loading",src:r?"../../../static/images/".concat(r):""}),Object(O.jsx)("h5",{className:"beep-client-text",children:"Bienvenue"}),g?Object(O.jsx)("button",{className:"btn-submit btn text",onClick:function(){j(!0)},children:"Consulter beep"}):Object(O.jsx)(R,{setBeepToken:y,setShowBepp:j,restaurantId:e}),Object(O.jsx)("button",{className:"btn-submit btn text",children:"Voir la carte"}),Object(O.jsx)("button",{className:"btn-submit btn text",children:"Mes points fid\xe9lit\xe9"})]})}),m&&u&&Object(O.jsxs)("div",{className:"beep-client-container2",children:[Object(O.jsx)("div",{className:"btn-back-container",children:Object(O.jsxs)("div",{className:"beep btn-back",onClick:function(){j(!1)},children:[Object(O.jsx)("img",{alt:"loading",src:"../../img/btn-back.png"}),Object(O.jsx)("span",{children:"Retour"})]})}),Object(O.jsx)(S,{beep:u})]})]})}),q=Object(a.lazy)((function(){return n.e(14).then(n.bind(null,167))})),L=Object(a.lazy)((function(){return n.e(8).then(n.bind(null,168))})),B=Object(a.lazy)((function(){return n.e(5).then(n.bind(null,169))})),H=Object(a.lazy)((function(){return n.e(20).then(n.bind(null,170))})),E=Object(a.lazy)((function(){return n.e(12).then(n.bind(null,171))})),M=Object(a.lazy)((function(){return n.e(10).then(n.bind(null,172))})),_=Object(a.lazy)((function(){return n.e(9).then(n.bind(null,173))})),F=Object(a.lazy)((function(){return n.e(13).then(n.bind(null,174))})),G=Object(a.lazy)((function(){return n.e(7).then(n.bind(null,175))})),Q=Object(a.lazy)((function(){return n.e(15).then(n.bind(null,176))})),V=Object(a.lazy)((function(){return n.e(16).then(n.bind(null,177))})),J=Object(a.lazy)((function(){return Promise.all([n.e(3),n.e(18)]).then(n.bind(null,178))})),U=Object(a.lazy)((function(){return n.e(11).then(n.bind(null,179))})),W=Object(a.lazy)((function(){return n.e(17).then(n.bind(null,180))})),D=Object(a.lazy)((function(){return Promise.all([n.e(6),n.e(4)]).then(n.bind(null,182))})),K=Object(a.lazy)((function(){return n.e(19).then(n.bind(null,181))}));function X(){return window.OneSignal=window.OneSignal||[],Object(O.jsx)(s.a,{children:Object(O.jsx)(a.Suspense,{fallback:Object(O.jsx)("div",{className:"container-loader",children:Object(O.jsx)("div",{className:"loader"})}),children:Object(O.jsxs)(o.d,{children:[Object(O.jsx)(f,{path:"/",exact:!0,component:E,restricted:!0}),Object(O.jsx)(f,{path:j.superAdminLoginPage,exact:!0,component:q,restricted:!0}),Object(O.jsx)(k,{path:j.superAdminHomePage,exact:!0,component:L,requiredRole:"superAdmin"}),Object(O.jsx)(k,{path:j.superAdminRestaurantsPage,exact:!0,component:B,requiredRole:"superAdmin"}),Object(O.jsx)(k,{path:j.superAdminManagePage,exact:!0,component:H,requiredRole:"superAdmin"}),Object(O.jsx)(f,{path:j.adminRegisterPage,exact:!0,component:E,restricted:!0,type:"register"}),Object(O.jsx)(f,{path:j.adminRegisterProPage,exact:!0,component:E,restricted:!0,type:"pro"}),Object(O.jsx)(f,{path:j.adminLoginPage,exact:!0,component:M,restricted:!0}),Object(O.jsx)(f,{path:j.adminForgotPassword,exact:!0,component:_,restricted:!0}),Object(O.jsx)(f,{path:j.adminResetPassword,exact:!0,component:F,restricted:!0}),Object(O.jsx)(f,{path:j.ClientRoute,exact:!0,component:T,restricted:!0}),Object(O.jsx)(k,{path:j.adminHomePage,exact:!0,component:G,requiredRole:"admin"}),Object(O.jsx)(k,{path:j.adminAccountPage,exact:!0,component:Q,requiredRole:"admin"}),Object(O.jsx)(k,{path:j.adminLogoPage,exact:!0,component:V,requiredRole:"admin"}),Object(O.jsx)(k,{path:j.adminConfidentialityPage,exact:!0,component:U,requiredRole:"admin"}),Object(O.jsx)(k,{path:j.adminPaymentPage,exact:!0,component:W,requiredRole:"admin"}),Object(O.jsx)(k,{path:j.adminQRCode,exact:!0,component:J,requiredRole:"admin"}),Object(O.jsx)(k,{path:j.adminBeeps,component:D,requiredRole:"admin"}),Object(O.jsx)(o.b,{path:"*",component:K})]})})})}i.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(X,{})}),document.getElementById("root"))},34:function(e,t,n){"use strict";t.a={adminRegisterPage:"/register",adminRegisterProPage:"/register/pro",adminLoginPage:"/login",adminForgotPassword:"/forgot-password",adminResetPassword:"/reset-password/:token",adminHomePage:"/restaurant/admin",adminAccountPage:"/restaurant/parameter/account",adminLogoPage:"/restaurant/parameter/logo",adminBeeps:"/restaurant/admin/beeps",adminConfidentialityPage:"/restaurant/parameter/confidentiality",adminQRCode:"/restaurant/parameter/QRCode",adminPaymentPage:"/restaurant/parameter/payment"}},36:function(e,t,n){"use strict";t.a={superAdminLoginPage:"/superAdmin/login",superAdminHomePage:"/superAdmin",superAdminRestaurantsPage:"/superAdmin/restaurants",superAdminManagePage:"/superAdmin/manage"}},49:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var a=n(2),r=n.n(a),c=n(6),i=n(17),s=n.n(i),o=function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(r.a.mark((function e(n,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s()({url:"/api/beeps",method:"get",headers:{Authorization:"auth-token:".concat(t),"Content-Type":"application/json"}}).then(function(){var e=Object(c.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.data.beeps,n(a);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var t;a(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.message,e.message)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(r.a.mark((function e(n,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post("/api/beeps/generate",{restaurantId:t}).then((function(e){e.data.success||a(e.data.message),n(e.data.token)})).catch((function(e){return a(e.message)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},72:function(e,t,n){}},[[129,1,2]]]);
//# sourceMappingURL=main.cc0c9eb1.chunk.js.map